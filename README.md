# PDF-accesibility-checker
Repository with tools to perform a PDF accesibility checker

## Tools included
### apps-script/PDFReports.gs
Script for Google Sheet to copy over columns generated by the PDF Accesibility report to all the other tabs where the PDF name matches

### wp-cli/find-pdfs.php
WP CLI script to grab all the PDFs from a WordPress single/multisite instance.
To use this CLI command:
```
    wp mscm find-pdfs export --post_types=posts,page --network=true
```
This will output a single CSV file or one CSV per site in case of multisite and `--network=true` flag

#### Options
* [<output>]* : The name of the output file (default: pdfs-{site}.csv)
	
* [--post_types=<post_types>]* : Comma separated list of post types to search (default: post)
	
* [--network=<bool>] * : Whether to search across the entire network (default: false)
	
* [--start_date=<date>] * : Filter posts from this date onwards (format: MM-DD-YYYY)

### download-files.sh
This bash script will get data from a passed CSV and download each file described by the `url` column using `wget`
I've decied using `wget` because it has a built-in feature to follow links in case of redirections.
Then the script will rename every file which isn't a PDF to a PDF since we're sure we're dealing wiht a PDF and PDFs behind the redirects, doesn't respect the filename and not giving the proper extension.
After making sure we have just PDF files, the script will loop again on pdf files in the directory and run the accesibility checker node script on each file

#### About Adobe acrobat sevice APIs
In order to use these APIs you need to create [your credentials](https://acrobatservices.adobe.com/dc-integration-creation-app-cdn/main.html?api=pdf-services-api)
With that you can add those to your Environment varibales
```
export PDF_SERVICES_CLIENT_ID=<client_id>
export PDF_SERVICES_CLIENT_SECRET=<client_secret>
```


use:
```
    sh download-files.sh input_csv.csv DirectoryToDownloadFiles/ <csv_col_number>
```

** Note: the csv_row_number parameter indicates in which column position is the PDF url

### pdf-accesibility-checker.js
This is a script that runs the PDF accesibility checker on a PDF passed and will return a json report with the details of the test.

use:
```
    node pdf-accesibility-checker.js some-pdf-file.pdf
```

### parser-merger.js
This is the final script that parse and merges CSV input file with PDF accesibility reports and adds each test on a column to make the reports in the spreadsheets more readable

this script will take the first parameter as the same name as the CSV that contains a full list of PDFs from a site and attach to each row all the test on a single column and output the resultant CSV in a folder with the same name.

use:
```
    node parser-merger.js final-pdf-report-with-all-the-PDFs
```